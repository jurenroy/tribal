<html>
  <head>
    <meta charset="utf-8">
    <title>My Electron App - Second Page</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="id-info">
      <h1>ID Card</h1>
      <div class="image-cropper">
        <img id="image-file" alt="Photo" width="200" height="200">
      </div>
      <p>ID Number: <span id="id-number"></span></p>
      <p>Name: <span id="name"></span></p>
      <p>Datu Name: <span id="datu-name"></span></p>
    </div>

    <div id="contact-info">
      <h1>Contact Information</h1>
      <p>Mobile Number: <span id="mobile-number"></span></p>
      <p>Address: <span id="address"></span></p>
      <p>Contact Person: <span id="contact-person"></span></p>
      <p>Contact Number: <span id="contact-number"></span></p>
    </div>
    
    <div id="button-group">
      <button id="back-button">Back</button>
      <button id="upload-button">Upload Picture</button>
    </div>
    

    <script src="https://unpkg.com/cropperjs/dist/cropper.js"></script>
    <script>
      // Get the query string from the URL
      const queryString = window.location.search;
      // Parse the query string into a URLSearchParams object
      const params = new URLSearchParams(queryString);
    
      // Get the form data from the query string using the names of the form fields
      const idNumber = params.get("id-number");
      const name = params.get("name");
      const datuName = params.get("datu-name");
      const mobileNumber = params.get("mobile-number");
      const address = params.get("address");
      const contactPerson = params.get("contact-person");
      const contactNumber = params.get("contact-number");
      const imageFile = params.get("image-file");
    
      // Set the form data to the HTML elements on the page
      document.getElementById("id-number").textContent = idNumber;
      document.getElementById("name").textContent = name;
      document.getElementById("datu-name").textContent = datuName;
      document.getElementById("mobile-number").textContent = mobileNumber;
      document.getElementById("address").textContent = address;
      document.getElementById("contact-person").textContent = contactPerson;
      document.getElementById("contact-number").textContent = contactNumber;
    
      // Set the image file to the image element on the page
      const imgElement = document.getElementById('image-file');
      imgElement.src = imageFile;
    
      // Add a click event listener to the back button to navigate back to the first page
      document.getElementById("back-button").addEventListener("click", () => {
        window.history.back();
      });
    
      // Add a change event listener to the image upload input to read and display the selected image
      document.getElementById("upload-picture").addEventListener("change", (event) => {
        const file = event.target.files[0];
        const reader = new FileReader();
    
        reader.onload = (event) => {
          const image = new Image();
          image.src = event.target.result;
    
          image.onload = () => {
            // Resize the image to fit inside the image cropper
            const canvas = document.createElement('canvas');
            const maxDimension = Math.max(image.width, image.height);
            canvas.width = canvas.height = maxDimension;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(image, (maxDimension - image.width) / 2, (maxDimension - image.height) / 2);
    
            // Set the cropped image as the source of the image element
            imgElement.src = canvas.toDataURL();
          };
        };
    
        reader.readAsDataURL(file);
      });
    </script>    
  </body>
</html>